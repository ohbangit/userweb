# 오뱅잇 — 스트리밍 스케줄 기획문서

## 1. 프로젝트 개요

| 항목        | 내용                                                                             |
| ----------- | -------------------------------------------------------------------------------- |
| 서비스명    | 오뱅잇                                                                           |
| 목적        | 스트리머 방송 스케줄을 일간/주간/월간으로 조회                                   |
| 타겟 환경   | 데스크톱 (768px+), 모바일 (320px–767px)                                          |
| 디자인 철학 | 토스, 카카오, 당근마켓 UI/UX 참고 — 모바일 퍼스트, 넉넉한 터치 영역, 깔끔한 여백 |
| 테마 참고   | 치지직(Chzzk) 테마 컬러 기반 라이트/다크 모드                                    |

## 2. 기술 스택

| 분류           | 기술                                         |
| -------------- | -------------------------------------------- |
| 프레임워크     | React 18 + TypeScript                        |
| 빌드 도구      | Vite 5                                       |
| 스타일링       | Tailwind CSS v4 (`@theme` 기반 CSS 변수)     |
| 아이콘         | lucide-react (tree-shakeable SVG 아이콘)     |
| 날짜 처리      | dayjs                                        |
| 데이터 페칭    | TanStack Query v5 (useQuery/useMutation)     |
| API 클라이언트 | 네이티브 fetch 래퍼 (`src/lib/apiClient.ts`) |
| 패키지 매니저  | yarn (v1 classic)                            |

## 3. 디자인 시스템

### 3.1. 테마 정책

- **기본값**: 라이트 모드
- **전환 방식**: 헤더 우측 토글 버튼 (Sun/Moon 아이콘)
- **저장**: `localStorage` (`ohbangit-theme` 키)
- **시스템 연동**: `prefers-color-scheme` 감지, 저장값 없으면 시스템 설정 따름
- **플리커 방지**: `index.html`에 인라인 스크립트로 React 마운트 전 `.dark` 클래스 적용

### 3.2. 컬러 토큰

| 토큰           | 라이트    | 다크      | 용도               |
| -------------- | --------- | --------- | ------------------ |
| `primary`      | `#00dc82` | `#00ffa3` | 브랜드 강조색      |
| `primary-dim`  | `#00b368` | `#00cc82` | 브랜드 보조색      |
| `bg`           | `#ffffff` | `#0e0e10` | 배경               |
| `bg-secondary` | `#f7f7f8` | `#1a1a23` | 보조 배경          |
| `card`         | `#ffffff` | `#26262e` | 카드 배경          |
| `card-hover`   | `#f0f0f2` | `#2e2e38` | 카드 호버          |
| `border`       | `#e5e5ea` | `#3a3a44` | 테두리             |
| `text`         | `#1b1b1f` | `#efeff1` | 본문 텍스트        |
| `text-muted`   | `#6b6b7b` | `#adadb8` | 보조 텍스트        |
| `text-dim`     | `#9e9eae` | `#848494` | 비활성 텍스트      |
| `live`         | `#ff4654` | `#ff4654` | 라이브 상태        |
| `collab`       | `#9b6bff` | `#bf94ff` | 합방 상태          |
| `category`     | `#f0f0f5` | `#2a2a35` | 카테고리 뱃지 배경 |

### 3.3. 타이포그래피

- **폰트**: Inter, Pretendard, 시스템 폰트 폴백
- **안티앨리어싱**: `-webkit-font-smoothing: antialiased`

### 3.4. 아이콘 정책

- **라이브러리**: `lucide-react` (v0.564.0)
- **사이징**: Tailwind 유틸리티 (`h-4 w-4`, `h-5 w-5` 등)
- **컬러링**: `currentColor` 기반, 부모 텍스트 색상 상속
- **사용 위치**: 네비게이션, 테마 토글, 모달 닫기, 정보 항목 레이블, 외부 링크

| 아이콘         | 컴포넌트             | 용도                                   |
| -------------- | -------------------- | -------------------------------------- |
| `Sun`          | Header               | 라이트 모드 전환 (다크 모드일 때 표시) |
| `Moon`         | Header               | 다크 모드 전환 (라이트 모드일 때 표시) |
| `ChevronLeft`  | SchedulePage         | 이전 날짜 네비게이션                   |
| `ChevronRight` | SchedulePage         | 다음 날짜 네비게이션                   |
| `X`            | BroadcastDetailModal | 모달 닫기                              |
| `ExternalLink` | BroadcastDetailModal | 방송국 외부 링크                       |
| `Calendar`     | BroadcastDetailModal | 날짜 정보 레이블                       |
| `Clock`        | BroadcastDetailModal | 시간 정보 레이블                       |
| `Gamepad2`     | BroadcastDetailModal | 카테고리 정보 레이블                   |
| `Hash`         | BroadcastDetailModal | 태그 정보 레이블                       |
| `Tv`           | BroadcastDetailModal | 방송국 정보 레이블                     |
| `Users`        | BroadcastDetailModal | 참여자 섹션 레이블                     |

## 4. 반응형 정책

### 4.1. 브레이크포인트

| 이름          | 범위    | 역할                      |
| ------------- | ------- | ------------------------- |
| 모바일 (기본) | 0–639px | 모바일 퍼스트 기본 스타일 |
| `sm`          | 640px+  | 태블릿/소형 데스크톱 보정 |
| `md`          | 768px+  | 데스크톱 그리드 전환      |

### 4.2. 레이아웃 정책

| 영역            | 모바일                       | 데스크톱               |
| --------------- | ---------------------------- | ---------------------- |
| AppLayout 패딩  | `px-4 py-4`                  | `px-6 py-6`            |
| Header 패딩     | `px-4`                       | `px-6`                 |
| Footer 패딩     | `px-4 py-6`                  | `px-6 py-8`            |
| 네비게이션 버튼 | `h-10 w-10` (44px 터치 영역) | `h-8 w-8`              |
| 뷰 토글 버튼    | `px-3 py-2` (넉넉한 터치)    | `px-4 py-1.5`          |
| "오늘" 버튼     | `px-4 py-2`                  | `px-3 py-1.5`          |
| 상단 바         | 세로 스택 (`flex-col`)       | 가로 배치 (`flex-row`) |

### 4.3. 뷰별 반응형

| 뷰       | 모바일                                                         | 데스크톱                          |
| -------- | -------------------------------------------------------------- | --------------------------------- |
| **일간** | 카드 패딩 `p-3`, 시간 칼럼 `w-14`                              | 카드 패딩 `p-4`, 시간 칼럼 `w-16` |
| **주간** | 가로 스크롤 (`overflow-x-auto snap-x`), 요일별 `min-w-[200px]` | 7컬럼 그리드 (`grid-cols-7`)      |
| **월간** | 가로 스크롤, 내부 `min-w-[640px]`, 셀 `min-h-[80px]`           | 셀 `min-h-[120px]`, 스크롤 없음   |

## 5. 데이터 모델

### 5.1. Broadcast

```typescript
interface Broadcast {
    id: string
    title: string
    streamerName: string
    streamerProfileUrl?: string
    streamerChannelUrl?: string
    streamerIsPartner?: boolean
    gameTitle?: string
    tags?: string[]
    participants?: Participant[]
    startTime: string // ISO 8601
    endTime?: string // ISO 8601
    isLive: boolean
    isCollab: boolean
    collabPartners?: string[]
    thumbnailUrl?: string
}
```

### 5.2. Participant

```typescript
interface Participant {
    name: string
    avatarUrl?: string
    channelUrl?: string
}
```

### 5.3. ViewMode

```typescript
type ViewMode = 'daily' | 'weekly' | 'monthly'
```

## 6. 기능 명세

### 6.1. 스케줄 네비게이션

| 기능      | 설명                                                                              |
| --------- | --------------------------------------------------------------------------------- |
| 뷰 전환   | 일간 / 주간 / 월간 토글 (기본값: 주간)                                            |
| 날짜 이동 | 이전/다음 버튼 (일간: ±1일, 주간: ±7일, 월간: ±1개월)                             |
| 오늘 버튼 | 현재 날짜로 즉시 이동                                                             |
| 기간 표시 | 일간: `2026년 2월 15일 (일)`, 주간: `2026년 2월 3주차` + 범위, 월간: `2026년 2월` |
| 헤더 높이 | 일정 섹션 헤더(날짜/모드) 높이 고정으로 뷰 전환 시 레이아웃 변동 없음             |

### 6.2. 일간 뷰 (DailySchedule)

- **카드 구성**: 컬러바 → 시간(시작 – 종료 인라인) → 제목(볼드) → 참여자 스택 + 레이블 → 카테고리/태그
- **컬러바**: 상태별 그라디언트 (LIVE: 빨강, 합방: 보라, 일반: 녹색)
- **참여자 스택**: 아바타 최대 3명 표시, 초과 시 `+N` 뱃지 (대표 스트리머는 `streamerProfileUrl`을 썸네일로 폴백)
- **참여자 레이블**: 1명이면 이름, 2명 이상이면 `홍길동 외 N명`
- **카드 클릭**: 상세 모달 오픈
- **빈 상태**: "예정된 방송이 없습니다" + "다른 날짜를 확인해 보세요"
- **방송 수 표시**: 상단에 `N개의 방송`

### 6.3. 주간 뷰 (WeeklySchedule)

- **레이아웃**: 요일별 컬럼 (월–일)
- **카드 구성**: 컬러바 → 시간(인라인) → 제목(1줄 말줄임 `...`) → 참여자 텍스트 → 카테고리 뱃지
- **오늘 표시**: 날짜 원형 뱃지 녹색, 컬럼 배경 미세 녹색 틴트
- **카드 클릭**: 상세 모달 오픈
- **빈 요일**: "방송 없음" 텍스트 중앙 표시
- **일정 초과 표시**: 요일당 최대 3개 카드 표시, 초과 시 `+N개 더보기` 버튼 노출
    - 더보기 버튼 클릭 → **일별 방송 목록 모달 (DayBroadcastListModal)** 오픈
    - 목록 모달 내 카드 클릭 → 목록 모달 닫힘 → **상세 모달 (BroadcastDetailModal)** 오픈
    - 2단계 팝업 플로우: `더보기 → 일별 목록 → 상세`

### 6.4. 월간 뷰 (MonthlySchedule)

- **레이아웃**: 7컬럼 달력 그리드
- **셀 구성**: 날짜 숫자 + 방송 수 + 방송 목록 (최대 2개)
- **카드 variant**: `full` — 상태 도트 + 시작시간 + 제목 (한 줄)
- **오늘 표시**: 날짜 원형 녹색 배경
- **이번 달/다른 달**: 다른 달 셀은 배경색 구분 (`bg-bg-secondary/50`)
- **초과 표시**: 3개 이상이면 `+N개` 텍스트
- **셀 클릭**: 해당 날짜의 **일간 뷰**로 전환 (`viewMode → 'daily'` + `currentDate → 클릭한 날짜`)
    - 셀 전체가 클릭 영역 (`<button>`, `cursor-pointer`)
    - 호버 시 배경색 변경 (`hover:bg-card-hover/50`)
    - 월간 뷰는 오버뷰 역할에 집중, 상세 탐색은 일간 뷰에 위임

### 6.5. 일별 방송 목록 모달 (DayBroadcastListModal)

#### 트리거

- 주간 뷰에서 `+N개 더보기` 버튼 클릭

#### 레이아웃

| 환경               | 형태                                            |
| ------------------ | ----------------------------------------------- |
| 모바일 (< 640px)   | 바텀시트 — 하단에서 올라옴, 하단 닫기 버튼 표시 |
| 데스크톱 (≥ 640px) | 센터 모달 — 최대 폭 `max-w-md`                  |

#### 모달 구성

| 영역          | 내용                                                        |
| ------------- | ----------------------------------------------------------- |
| 헤더          | 날짜 레이블 (`2월 15일 (일)`) + 방송 수 뱃지 + 닫기(X) 버튼 |
| 목록          | 해당 일의 전체 방송 카드 (compact variant, 세로 스크롤)     |
| 하단 (모바일) | 전체 너비 닫기 버튼                                         |

#### 인터랙션

| 동작                    | 결과                                    |
| ----------------------- | --------------------------------------- |
| 카드 클릭               | 목록 모달 닫힘 → 방송 상세 모달 오픈    |
| ESC 키                  | 모달 닫기                               |
| 백드롭 클릭             | 모달 닫기                               |
| X 버튼 클릭             | 모달 닫기                               |
| 하단 닫기 버튼 (모바일) | 모달 닫기                               |
| 모달 열림 시            | `body` 스크롤 잠금 (`overflow: hidden`) |
| 모달 닫힘 시            | `body` 스크롤 복원                      |

### 6.6. 방송 상세 모달 (BroadcastDetailModal)

#### 트리거

- 일간 카드 클릭
- 주간 카드 클릭
- 주간 일별 목록 모달 내 카드 클릭

#### 레이아웃

| 환경               | 형태                                            |
| ------------------ | ----------------------------------------------- |
| 모바일 (< 640px)   | 바텀시트 — 하단에서 올라옴, 하단 닫기 버튼 표시 |
| 데스크톱 (≥ 640px) | 센터 모달 — 최대 폭 `max-w-lg`, 하단 버튼 숨김  |

#### 모달 구성

| 영역          | 내용                                                   |
| ------------- | ------------------------------------------------------ |
| 헤더          | 상태 뱃지 (LIVE / 합방 / 예정) + 닫기(X) 버튼          |
| 타이틀        | 방송 제목 (`text-lg` 모바일, `text-xl` 데스크톱, 볼드) |
| 정보 섹션     | 아이콘 + 레이블 + 값 형태의 정보 행                    |
| 참여자 섹션   | 참여자 전체 목록 — 세로 스크롤 (아바타 + 이름 카드)    |
| 하단 (모바일) | 전체 너비 닫기 버튼                                    |

#### 정보 항목

| 아이콘   | 레이블   | 값                                                           |
| -------- | -------- | ------------------------------------------------------------ |
| Calendar | 날짜     | `2월 15일 (일)`                                              |
| Clock    | 시간     | `20:00 – 23:00` (시작 볼드, 종료 보조색)                     |
| Gamepad2 | 카테고리 | 뱃지 형태                                                    |
| Hash     | 태그     | `#태그1 #태그2` 뱃지 나열 (태그 있을 때만)                   |
| Users    | 참여자   | 참여자 목록 표시 (매칭된 스트리머는 치지직 아이콘 링크 표시) |

#### 참여자 목록 정책

- **정렬**: 한국어 이름 기준 오름차순 (`localeCompare('ko')`)
- **아바타 폴백**: 매칭된 스트리머 썸네일(`channel_image_url`) 우선, 없으면 이름 첫 글자 이니셜
- **레이아웃**: 세로 스택 (가로 스크롤 대비 발견성, 정보 가독성 우수)
- **폴백**: 참여자 데이터 없으면 `streamerName`을 기본 참여자로 생성

#### 인터랙션

| 동작                    | 결과                                    |
| ----------------------- | --------------------------------------- |
| ESC 키                  | 모달 닫기                               |
| 백드롭 클릭             | 모달 닫기                               |
| X 버튼 클릭             | 모달 닫기                               |
| 하단 닫기 버튼 (모바일) | 모달 닫기                               |
| 모달 열림 시            | `body` 스크롤 잠금 (`overflow: hidden`) |
| 모달 닫힘 시            | `body` 스크롤 복원                      |

### 6.7. 테마 토글

| 항목      | 설명                                                      |
| --------- | --------------------------------------------------------- |
| 위치      | 헤더 우측                                                 |
| 크기      | `h-9 w-9`                                                 |
| 아이콘    | 다크 모드 → Sun (밝은 모드 전환 의미), 라이트 모드 → Moon |
| 접근성    | `aria-label` 동적 설정                                    |
| 전환 효과 | `background-color`, `color` 0.2s ease 트랜지션            |

### 6.8. 문의하기

#### 구성

| 항목      | 내용                                                               |
| --------- | ------------------------------------------------------------------ |
| 진입      | 우측 하단 플로팅 버튼 클릭 시 패널 확장                            |
| 필드      | 제목(필수), 이메일(선택), 문의 유형(필수), 내용(필수)              |
| 문의 유형 | 일정 제보, 기타 건의                                               |
| 반응형    | 모바일: 좌우 여백을 둔 전체 폭 패널, 데스크톱: 버튼 우측 상단 패널 |

#### 서버 연동

| 항목            | 내용                                                          |
| --------------- | ------------------------------------------------------------- |
| 엔드포인트      | `POST /api/contact/inquiries`                                 |
| 처리 방식       | 디스코드 전송 (저장 없음)                                     |
| 클라이언트 검증 | 제목 2~80자, 내용 10~2000자                                   |
| 전송 상태       | 전송 중 버튼 비활성화 + "전송 중..." 표시                     |
| 성공 피드백     | "문의가 전송되었습니다" 메시지 (3초 후 자동 숨김) + 폼 초기화 |
| 실패 피드백     | "전송에 실패했습니다. 다시 시도해 주세요" 에러 메시지         |
| 상태 관리       | `useSubmitInquiry` (TanStack Query useMutation)               |

#### 인터랙션

| 동작             | 결과                              |
| ---------------- | --------------------------------- |
| 플로팅 버튼 클릭 | 문의 패널 열림/닫힘 토글          |
| 패널 열림        | 배경 딤 처리, 뒤 컨텐츠 클릭 불가 |
| 백드롭 클릭      | 문의 패널 닫힘                    |

### 6.9. 관리자 — 스트리머 발굴

#### 목적

- 치지직 인기 라이브 목록에서 신규 스트리머 후보를 수집하고, 운영자가 선택 등록한다.
- 반복 노출되는 불필요 채널은 예외 목록으로 관리해 다음 발굴 결과에서 자동 제외한다.

#### 화면 구성

| 영역        | 내용                                                        |
| ----------- | ----------------------------------------------------------- |
| 상단 액션   | `크롤링 실행`, `추가로 가져오기` 버튼                       |
| 후보 테이블 | 체크박스, 스트리머 정보(썸네일/이름/파트너 뱃지), 채널 ID   |
| 선택 액션   | `선택 등록`, `선택 예외 처리` 버튼                          |
| 예외 관리   | 수동 예외 추가 폼(channelId, 이름, 사유) + 예외 목록 테이블 |

#### API 연동

| 기능           | 엔드포인트                                                   |
| -------------- | ------------------------------------------------------------ |
| 발굴 실행      | `POST /api/admin/streamer-discovery/run`                     |
| 후보 등록      | `POST /api/admin/streamer-discovery/register`                |
| 예외 조회      | `GET /api/admin/streamer-discovery/exclusions`               |
| 예외 추가      | `POST /api/admin/streamer-discovery/exclusions`              |
| 예외 벌크 추가 | `POST /api/admin/streamer-discovery/exclusions/bulk`         |
| 예외 삭제      | `DELETE /api/admin/streamer-discovery/exclusions/:channelId` |

- 추가 크롤링은 커서(`concurrentUserCount`, `liveId`)를 전달해 다음 페이지를 이어서 수집한다.
- 발굴 요청 기본 파라미터는 `size=20`, `sortType=POPULAR`를 사용한다.

### 6.10. 관리자 — 스트리머 관리

#### 화면 구성

| 영역 | 내용                                |
| ---- | ----------------------------------- |
| 상단 | 전체/채널 미등록 탭, 이름 검색      |
| 목록 | 스트리머 테이블 + 클릭 시 상세 모달 |
| 하단 | 페이지네이션(이전/다음, 총 개수)    |

#### 동작

- 목록 조회는 페이지네이션(`page`, `size`)을 포함해 서버에서 분할 조회한다.

### 6.8. Footer

| 영역 | 내용                                                |
| ---- | --------------------------------------------------- |
| 좌측 | 서비스명 + 한 줄 설명                               |
| 우측 | 이용약관/개인정보처리방침 텍스트 + 문의 메일        |
| 하단 | 저작권 문구 (`© 2026 오뱅잇. All rights reserved.`) |

## 7. 컴포넌트 구조

```
src/
├── app/
│   ├── App.tsx                    # 루트 — AppLayout + SchedulePage
│   ├── components/
│   │   ├── Footer.tsx             # 푸터 (서비스 정보 + 정책/문의)
│   │   └── Header.tsx             # 헤더 (로고 + 테마 토글)
│   └── layouts/
│       └── AppLayout.tsx          # 레이아웃 셸 (Header + main)
├── features/
│   └── schedule/
│       ├── components/
│       │   ├── BroadcastCard.tsx          # 주간/월간 카드 (compact/full variant)
│       │   ├── BroadcastDetailModal.tsx   # 방송 상세 모달 (API 상세 fetch)
│       │   ├── DailySchedule.tsx          # 일간 뷰 + 일간 카드
│       │   ├── DayBroadcastListModal.tsx  # 주간 뷰 일별 방송 목록 모달 (더보기)
│       │   ├── MonthlySchedule.tsx        # 월간 뷰
│       │   └── WeeklySchedule.tsx         # 주간 뷰
│       ├── hooks/
│       │   ├── useSchedule.ts            # 스케줄 조회 hook (useQuery)
│       │   └── useBroadcastDetail.ts     # 방송 상세 조회 hook (useQuery)
│       ├── pages/
│       │   └── SchedulePage.tsx           # 스케줄 페이지 (API 연동, 로딩/에러 상태)
│       ├── types/
│       │   ├── schedule.ts               # Broadcast, Participant, ViewMode 타입
│       │   └── api.ts                    # API 응답 타입 (ScheduleResponse 등)
│       └── utils/
│           ├── date.ts                   # 날짜 유틸 (formatTime, getWeekDays 등)
│           └── mockData.ts              # 목 데이터 (개발용 보존)
│   └── contact/
│       ├── components/
│       │   └── ContactPanel.tsx          # 플로팅 문의하기 패널 (API 연동)
│       ├── hooks/
│       │   └── useSubmitInquiry.ts       # 문의 전송 hook (useMutation)
│       └── types/
│           └── api.ts                    # 문의 API 타입 (InquiryRequest 등)
├── hooks/
│   └── useTheme.ts               # 테마 관리 훅
├── lib/
│   └── apiClient.ts              # API 클라이언트 (fetch 래퍼, 에러 핸들링)
└── index.css                     # 테마 변수 + 유틸리티 클래스
```

## 8. 카드 UI 통일 정책

일간 카드의 디자인 언어를 기준으로 주간/월간 카드를 통일합니다.

### 공통 요소

| 요소      | 일간                      | 주간 (compact)                   | 월간 (full)               |
| --------- | ------------------------- | -------------------------------- | ------------------------- |
| 컬러바    | `w-1` 세로 그라디언트     | `w-0.5` 세로 그라디언트          | 상태 도트 (`h-1.5 w-1.5`) |
| 시간      | `시작 – 종료` 인라인      | `시작 – 종료` 인라인             | 시작 시간만               |
| 제목      | `text-base font-bold`     | `text-xs font-bold truncate`     | `text-[10px] truncate`    |
| 참여자    | 아바타 스택(3명) + 레이블 | 텍스트 레이블만                  | 없음                      |
| 카테고리  | 뱃지 + 태그               | 뱃지                             | 없음                      |
| LIVE 뱃지 | 애니메이션 펄스           | 빨간 하트비트 도트 (텍스트 없음) | 상태 도트로 대체          |
| 호버 효과 | 그림자 + 녹색 그라디언트  | 동일                             | 배경색 변경               |
| 클릭      | 상세 모달                 | 상세 모달                        | 없음                      |

### 컬러바 색상 규칙

| 상태 | 색상                        |
| ---- | --------------------------- |
| LIVE | `live` (빨강) 그라디언트    |
| 합방 | `collab` (보라) 그라디언트  |
| 일반 | `primary` (녹색) 그라디언트 |

## 9. 접근성

| 항목                | 적용                                                              |
| ------------------- | ----------------------------------------------------------------- |
| 터치 타겟           | 모바일 버튼 최소 44px (`h-10 w-10`)                               |
| aria-label          | 테마 토글, 모달 닫기 버튼                                         |
| aria-modal          | 상세 모달                                                         |
| role="dialog"       | 상세 모달                                                         |
| role="presentation" | 모달 백드롭                                                       |
| 키보드              | ESC로 모달 닫기                                                   |
| 시맨틱 요소         | 클릭 가능한 카드는 `<button>`, 헤더는 `<header>`, 본문은 `<main>` |
